openapi: 3.0.3
info:
  title: Snow School Scheduler API
  description: スキー・スノーボードスクールのシフト管理システム API
  version: 1.0.0
  contact:
    name: Snow School Scheduler

servers:
  - url: http://localhost:8787
    description: 開発環境
  - url: https://snow-school-scheduler-api.example.com
    description: 本番環境

paths:
  /api/health:
    get:
      summary: ヘルスチェック
      description: サーバーの稼働状況を確認
      tags:
        - システム
      responses:
        "200":
          description: サーバー稼働中
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "ok"

  /api/departments:
    get:
      summary: 部門一覧取得
      description: 全部門の一覧を取得
      tags:
        - 部門管理
      responses:
        "200":
          description: 部門一覧
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Department"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/departments/[id]:
    parameters:
      - $ref: "#/components/parameters/Id"

    get:
      summary: 部門詳細取得
      description: 指定された部門の詳細情報を取得
      tags:
        - 部門管理
      responses:
        "200":
          description: 部門詳細
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/Department"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/certifications:
    get:
      summary: 資格一覧取得
      description: 全資格の一覧を取得
      tags:
        - 資格管理
      responses:
        "200":
          description: 資格一覧
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/Certification"
        "500":
          $ref: "#/components/responses/ServerError"

    post:
      summary: 資格作成
      description: 新しい資格を作成
      tags:
        - 資格管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CertificationInput"
      responses:
        "201":
          description: 資格作成成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/Certification"
                      message:
                        type: string
                        example: "Certification created successfully"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/certifications/[id]:
    parameters:
      - $ref: "#/components/parameters/Id"

    get:
      summary: 資格詳細取得
      description: 指定された資格の詳細情報を取得
      tags:
        - 資格管理
      responses:
        "200":
          description: 資格詳細
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/CertificationDetail"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    put:
      summary: 資格更新
      description: 指定された資格を更新
      tags:
        - 資格管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CertificationInput"
      responses:
        "200":
          description: 資格更新成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Certification"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/instructors:
    get:
      summary: インストラクター一覧取得
      description: インストラクターの一覧を取得（ステータス絞り込み可能）
      tags:
        - インストラクター管理
      parameters:
        - name: status
          in: query
          description: ステータスでフィルタリング
          schema:
            type: string
            enum: [ACTIVE, INACTIVE, RETIRED]
      responses:
        "200":
          description: インストラクター一覧
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          allOf:
                            - $ref: "#/components/schemas/Instructor"
                            - type: object
                              properties:
                                certifications:
                                  type: array
                                  items:
                                    $ref: "#/components/schemas/InstructorCertification"
                                shiftAssignments:
                                  type: array
                                  items:
                                    $ref: "#/components/schemas/ShiftAssignment"
        "500":
          $ref: "#/components/responses/ServerError"

    post:
      summary: インストラクター作成
      description: 新しいインストラクターを作成
      tags:
        - インストラクター管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InstructorInput"
      responses:
        "201":
          description: インストラクター作成成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        allOf:
                          - $ref: "#/components/schemas/Instructor"
                          - type: object
                            properties:
                              certifications:
                                type: array
                                items:
                                  $ref: "#/components/schemas/InstructorCertification"
                              shiftAssignments:
                                type: array
                                items:
                                  $ref: "#/components/schemas/ShiftAssignment"
                      message:
                        type: string
                        example: "Instructor operation completed successfully"
        "400":
          $ref: "#/components/responses/ValidationError"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/instructors/[id]:
    parameters:
      - $ref: "#/components/parameters/Id"

    get:
      summary: インストラクター詳細取得
      description: 指定されたインストラクターの詳細情報を取得
      tags:
        - インストラクター管理
      responses:
        "200":
          description: インストラクター詳細
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        allOf:
                          - $ref: "#/components/schemas/Instructor"
                          - type: object
                            properties:
                              certifications:
                                type: array
                                items:
                                  $ref: "#/components/schemas/InstructorCertification"
                              shiftAssignments:
                                type: array
                                items:
                                  $ref: "#/components/schemas/ShiftAssignment"
                      message:
                        type: string
                        example: "Instructor operation completed successfully"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    put:
      summary: インストラクター更新
      description: 指定されたインストラクターを更新
      tags:
        - インストラクター管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InstructorInput"
      responses:
        "200":
          description: インストラクター更新成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        allOf:
                          - $ref: "#/components/schemas/Instructor"
                          - type: object
                            properties:
                              certifications:
                                type: array
                                items:
                                  $ref: "#/components/schemas/InstructorCertification"
                              shiftAssignments:
                                type: array
                                items:
                                  $ref: "#/components/schemas/ShiftAssignment"
                      message:
                        type: string
                        example: "Instructor operation completed successfully"
        "400":
          $ref: "#/components/responses/ValidationError"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":  
          $ref: "#/components/responses/ServerError"

  /api/instructor-certifications:
    get:
      summary: インストラクター資格関連一覧取得
      description: インストラクター資格関連の一覧を取得
      tags:
        - インストラクター資格関連
      responses:
        "200":
          description: インストラクター資格関連一覧
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/InstructorCertification"
        "500":
          $ref: "#/components/responses/ServerError"

    post:
      summary: インストラクター資格関連作成
      description: 新しいインストラクター資格関連を作成
      tags:
        - インストラクター資格関連
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InstructorCertificationInput"
      responses:
        "201":
          description: インストラクター資格関連作成成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InstructorCertification"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/instructor-certifications/[id]:
    parameters:
      - $ref: "#/components/parameters/Id"

    get:
      summary: インストラクター資格関連詳細取得
      description: 指定されたインストラクター資格関連の詳細情報を取得
      tags:
        - インストラクター資格関連
      responses:
        "200":
          description: インストラクター資格関連詳細
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InstructorCertificationDetail"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    put:
      summary: インストラクター資格関連更新
      description: 指定されたインストラクター資格関連を更新
      tags:
        - インストラクター資格関連
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InstructorCertificationInput"
      responses:
        "200":
          description: インストラクター資格関連更新成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InstructorCertification"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    delete:
      summary: インストラクター資格関連削除
      description: 指定されたインストラクター資格関連を削除
      tags:
        - インストラクター資格関連
      responses:
        "200":
          description: 削除成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        nullable: true
                        example: null
                      message:
                        type: string
                        example: "Operation completed successfully"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/shift-types:
    get:
      summary: シフト種類一覧取得
      description: 全シフト種類の一覧を取得
      tags:
        - シフト種類管理
      responses:
        "200":
          description: シフト種類一覧
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ShiftType"
        "500":
          $ref: "#/components/responses/ServerError"

    post:
      summary: シフト種類作成
      description: 新しいシフト種類を作成
      tags:
        - シフト種類管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ShiftTypeInput"
      responses:
        "201":
          description: シフト種類作成成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ShiftType"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/shift-types/[id]:
    parameters:
      - $ref: "#/components/parameters/Id"

    get:
      summary: シフト種類詳細取得
      description: 指定されたシフト種類の詳細情報を取得
      tags:
        - シフト種類管理
      responses:
        "200":
          description: シフト種類詳細
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ShiftTypeDetail"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    put:
      summary: シフト種類更新
      description: 指定されたシフト種類を更新
      tags:
        - シフト種類管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ShiftTypeInput"
      responses:
        "200":
          description: シフト種類更新成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ShiftType"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    delete:
      summary: シフト種類削除
      description: 指定されたシフト種類を削除
      tags:
        - シフト種類管理
      responses:
        "200":
          description: 削除成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        nullable: true
                        example: null
                      message:
                        type: string
                        example: "Operation completed successfully"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/shifts:
    get:
      summary: シフト一覧取得
      description: シフトの一覧を取得（部門・種類・期間絞り込み可能）
      tags:
        - シフト管理
      parameters:
        - name: departmentId
          in: query
          description: 部門IDでフィルタリング
          schema:
            type: integer
        - name: shiftTypeId
          in: query
          description: シフト種類IDでフィルタリング
          schema:
            type: integer
        - name: dateFrom
          in: query
          description: 開始日でフィルタリング
          schema:
            type: string
            format: date
        - name: dateTo
          in: query
          description: 終了日でフィルタリング
          schema:
            type: string
            format: date
      responses:
        "200":
          description: シフト一覧
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiListResponse"
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/ShiftWithStats"
        "500":
          $ref: "#/components/responses/ServerError"

    post:
      summary: シフト作成
      description: 新しいシフトを作成
      tags:
        - シフト管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ShiftInput"
      responses:
        "201":
          description: シフト作成成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/ShiftWithStats"
                      message:
                        type: string
                        example: "Shift operation completed successfully"
        "400":
          $ref: "#/components/responses/ValidationError"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/shifts/[id]:
    parameters:
      - $ref: "#/components/parameters/Id"

    get:
      summary: シフト詳細取得
      description: 指定されたシフトの詳細情報を取得（割り当て統計付き）
      tags:
        - シフト管理
      responses:
        "200":
          description: シフト詳細
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/ShiftWithStats"
                      message:
                        type: string
                        example: "Shift operation completed successfully"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    put:
      summary: シフト更新
      description: 指定されたシフトを更新
      tags:
        - シフト管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ShiftInput"
      responses:
        "200":
          description: シフト更新成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        $ref: "#/components/schemas/ShiftWithStats"
                      message:
                        type: string
                        example: "Shift operation completed successfully"
        "400":
          $ref: "#/components/responses/ValidationError"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    delete:
      summary: シフト削除
      description: 指定されたシフトを削除
      tags:
        - シフト管理
      responses:
        "200":
          description: 削除成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ApiResponse"
                  - type: object
                    properties:
                      data:
                        type: object
                        nullable: true
                        example: null
                      message:
                        type: string
                        example: "Shift deleted successfully"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

  /api/shifts/[id]/assign:
    parameters:
      - $ref: "#/components/parameters/Id"

    get:
      summary: シフト割り当て状況取得
      description: 指定されたシフトの割り当て状況を取得
      tags:
        - シフト管理
      responses:
        "200":
          description: シフト割り当て状況
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      shiftId:
                        type: integer
                      assignments:
                        type: array
                        items:
                          $ref: "#/components/schemas/ShiftAssignment"
                      assignedCount:
                        type: integer
                        example: 2
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

    put:
      summary: シフト割り当て一括更新
      description: 指定されたシフトの割り当てを一括で更新（追加・削除を同時実行）
      tags:
        - シフト管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - instructorIds
              properties:
                instructorIds:
                  type: array
                  items:
                    type: integer
                  description: 割り当てるインストラクターのID配列
                  example: [1, 2, 3]
      responses:
        "200":
          description: 割り当て更新成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      added:
                        type: array
                        items:
                          type: integer
                        description: 新規追加されたインストラクターID
                        example: [1]
                      removed:
                        type: array
                        items:
                          type: integer
                        description: 削除されたインストラクターID
                        example: [4]
                      unchanged:
                        type: array
                        items:
                          type: integer
                        description: 変更されなかったインストラクターID
                        example: [2, 3]
                      current:
                        type: array
                        items:
                          type: integer
                        description: 現在の割り当てインストラクターID
                        example: [1, 2, 3]
                      assignments:
                        type: array
                        items:
                          $ref: "#/components/schemas/ShiftAssignment"
                      assignedCount:
                        type: integer
                        example: 3
                  message:
                    type: string
                    example: "Shift assignments updated successfully"
        "400":
          $ref: "#/components/responses/ValidationError"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/ServerError"

components:
  parameters:
    Id:
      name: id
      in: path
      required: true
      description: リソースのID
      schema:
        type: integer

  responses:
    NotFound:
      description: リソースが見つかりません
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApiErrorResponse"
          example:
            success: false
            data: null
            message: null
            error: "Resource not found"

    ValidationError:
      description: バリデーションエラー
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApiErrorResponse"
          example:
            success: false
            data: null
            message: null
            error: "Validation failed"

    ServerError:
      description: サーバーエラー
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApiErrorResponse"
          example:
            success: false
            data: null
            message: null
            error: "Internal server error"

  schemas:
    # 基本レスポンス
    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          nullable: true
        message:
          type: string
          nullable: true
          example: "Operation completed successfully"
        error:
          type: string
          nullable: true
          example: null

    ApiListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: array
          items:
            type: object
        count:
          type: integer
          example: 10
        message:
          type: string
          nullable: true
        error:
          type: string
          nullable: true
          example: null

    ApiErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        data:
          type: object
          nullable: true
          example: null
        message:
          type: string
          nullable: true
        error:
          type: string
          example: "Error message"

    # 部門関連
    Department:
      type: object
      properties:
        id:
          type: integer
        code:
          type: string
          example: "ski"
        name:
          type: string
          example: "スキー"
        description:
          type: string
          nullable: true
        isActive:
          type: boolean
          default: true
        colorPalette:
          type: string
          example: "red"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    DepartmentInput:
      type: object
      required:
        - code
        - name
        - colorPalette
      properties:
        code:
          type: string
          example: "ski"
        name:
          type: string
          example: "スキー"
        description:
          type: string
          nullable: true
        isActive:
          type: boolean
          default: true
        colorPalette:
          type: string
          example: "red"


    # 資格関連
    Certification:
      type: object
      properties:
        id:
          type: integer
        departmentId:
          type: integer
        name:
          type: string
          example: "スキー指導員"
        shortName:
          type: string
          nullable: true
          example: "指導員"
        organization:
          type: string
          example: "SAJ"
        description:
          type: string
          nullable: true
        isActive:
          type: boolean
          default: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        department:
          $ref: "#/components/schemas/Department"

    CertificationInput:
      type: object
      required:
        - departmentId
        - name
        - organization
      properties:
        departmentId:
          type: integer
        name:
          type: string
          example: "スキー指導員"
        shortName:
          type: string
          nullable: true
          example: "指導員"
        organization:
          type: string
          example: "SAJ"
        description:
          type: string
          nullable: true
        isActive:
          type: boolean
          default: true

    CertificationDetail:
      allOf:
        - $ref: "#/components/schemas/Certification"
        - type: object
          properties:
            instructorCertifications:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: integer
                  instructor:
                    $ref: "#/components/schemas/Instructor"

    # インストラクター関連
    Instructor:
      type: object
      properties:
        id:
          type: integer
        lastName:
          type: string
          example: "山田"
        firstName:
          type: string
          example: "太郎"
        lastNameKana:
          type: string
          nullable: true
          example: "ヤマダ"
        firstNameKana:
          type: string
          nullable: true
          example: "タロウ"
        status:
          type: string
          enum: [ACTIVE, INACTIVE, RETIRED]
          default: ACTIVE
        notes:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    InstructorInput:
      type: object
      required:
        - lastName
        - firstName
      properties:
        lastName:
          type: string
          example: "山田"
        firstName:
          type: string
          example: "太郎"
        lastNameKana:
          type: string
          nullable: true
          example: "ヤマダ"
        firstNameKana:
          type: string
          nullable: true
          example: "タロウ"
        status:
          type: string
          enum: [ACTIVE, INACTIVE, RETIRED]
          default: ACTIVE
        notes:
          type: string
          nullable: true

    # インストラクター資格関連
    InstructorCertification:
      type: object
      properties:
        id:
          type: integer
        instructorId:
          type: integer
        certificationId:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        certification:
          $ref: "#/components/schemas/Certification"

    InstructorCertificationInput:
      type: object
      required:
        - instructorId
        - certificationId
      properties:
        instructorId:
          type: integer
        certificationId:
          type: integer

    InstructorCertificationDetail:
      allOf:
        - $ref: "#/components/schemas/InstructorCertification"
        - type: object
          properties:
            instructor:
              $ref: "#/components/schemas/Instructor"

    # シフト種類関連
    ShiftType:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
          example: "レッスン"
        isActive:
          type: boolean
          default: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    ShiftTypeInput:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: "レッスン"
        isActive:
          type: boolean
          default: true

    ShiftTypeDetail:
      allOf:
        - $ref: "#/components/schemas/ShiftType"
        - type: object
          properties:
            shifts:
              type: array
              items:
                $ref: "#/components/schemas/Shift"

    # シフト関連
    Shift:
      type: object
      properties:
        id:
          type: integer
        date:
          type: string
          format: date-time
        departmentId:
          type: integer
        shiftTypeId:
          type: integer
        description:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        department:
          $ref: "#/components/schemas/Department"
        shiftType:
          $ref: "#/components/schemas/ShiftType"

    ShiftInput:
      type: object
      required:
        - date
        - departmentId
        - shiftTypeId
      properties:
        date:
          type: string
          format: date-time
        departmentId:
          type: integer
        shiftTypeId:
          type: integer
        description:
          type: string
          nullable: true

    ShiftWithStats:
      allOf:
        - $ref: "#/components/schemas/Shift"
        - type: object
          properties:
            assignments:
              type: array
              items:
                $ref: "#/components/schemas/ShiftAssignment"
            assignedCount:
              type: integer
              description: 現在割り当てられているインストラクター数

    # シフト割り当て関連
    ShiftAssignment:
      type: object
      properties:
        id:
          type: integer
        shiftId:
          type: integer
        instructorId:
          type: integer
        assignedAt:
          type: string
          format: date-time
        shift:
          $ref: "#/components/schemas/Shift"
        instructor:
          $ref: "#/components/schemas/Instructor"

    ShiftAssignmentInput:
      type: object
      required:
        - shiftId
        - instructorId
      properties:
        shiftId:
          type: integer
        instructorId:
          type: integer

    ShiftAssignmentDetail:
      allOf:
        - $ref: "#/components/schemas/ShiftAssignment"
        - type: object
          properties:
            shift:
              allOf:
                - $ref: "#/components/schemas/Shift"
                - type: object
                  properties:
                    department:
                      $ref: "#/components/schemas/Department"
                    shiftType:
                      $ref: "#/components/schemas/ShiftType"
            instructor:
              allOf:
                - $ref: "#/components/schemas/Instructor"
                - type: object
                  properties:
                    certifications:
                      type: array
                      items:
                        $ref: "#/components/schemas/InstructorCertification"

tags:
  - name: システム
    description: システム関連のエンドポイント
  - name: 部門管理
    description: 部門（スキー・スノーボード）の管理
  - name: 資格管理
    description: 資格マスタの管理
  - name: インストラクター管理
    description: インストラクターの管理
  - name: インストラクター資格関連
    description: インストラクターと資格の関連管理
  - name: シフト種類管理
    description: シフト種類マスタの管理
  - name: シフト管理
    description: シフト枠の管理
